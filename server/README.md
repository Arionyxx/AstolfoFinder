# Backend - Express.js Server

A Node.js backend built with Express, TypeScript, and Prisma ORM.

## ğŸ“‹ Setup

### Install Dependencies

From the root directory:
```bash
yarn install
```

### Environment Configuration

1. Copy the example environment file:
```bash
cp .env.example .env
```

2. Update `.env` with your configuration:
```env
PORT=5000
NODE_ENV=development
DATABASE_URL=postgresql://user:password@localhost:5432/monorepo_db
CORS_ORIGIN=http://localhost:5173
```

### Database Setup

1. Create PostgreSQL database:
```bash
createdb monorepo_db
```

2. Run migrations:
```bash
yarn dev # Will prompt to create initial migration if needed
# Or manually:
yarn migrate
```

## ğŸš€ Development

Start the development server with auto-reload:
```bash
yarn dev
```

The server will start at `http://localhost:5000`

## ğŸ”¨ Available Scripts

- `yarn dev` - Start development server with ts-node-dev
- `yarn build` - Build TypeScript to JavaScript
- `yarn start` - Run the built application
- `yarn lint` - Check code with ESLint
- `yarn lint:fix` - Fix linting issues
- `yarn type-check` - Run TypeScript compiler
- `yarn migrate` - Run Prisma migrations interactively
- `yarn migrate:deploy` - Deploy pending migrations (production)
- `yarn prisma:generate` - Generate Prisma Client

## ğŸ“ Project Structure

```
server/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts           # Express server entry point
â”‚   â””â”€â”€ ...                # Add your routes, controllers, models here
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma      # Database schema
â”‚   â””â”€â”€ migrations/        # Database migrations (auto-generated)
â”œâ”€â”€ dist/                  # Compiled JavaScript (generated by build)
â”œâ”€â”€ .env.example           # Environment variables template
â”œâ”€â”€ tsconfig.json          # TypeScript configuration
â”œâ”€â”€ .eslintrc.json         # ESLint configuration
â”œâ”€â”€ .prettierrc.json       # Prettier configuration
â””â”€â”€ package.json           # Dependencies and scripts
```

## ğŸ—„ï¸ Database

### Prisma Schema

The database schema is defined in `prisma/schema.prisma`. Example:

```prisma
model User {
  id    Int     @id @default(autoincrement())
  email String  @unique
  name  String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
```

### Running Migrations

Create a new migration:
```bash
yarn migrate
```

Deploy migrations to production:
```bash
yarn migrate:deploy
```

### Prisma Studio (GUI)

View and edit your database:
```bash
yarn prisma studio
```

## ğŸ”Œ API Endpoints

### Health Check
- `GET /health` - Server health status

Add more endpoints in `src/index.ts` or create separate route files.

## ğŸ“ Code Style

- **Linting**: ESLint with TypeScript support
- **Formatting**: Prettier
- **Pre-commit**: Husky hooks run lint and format on commit

Run linting:
```bash
yarn lint
```

Auto-fix linting issues:
```bash
yarn lint:fix
```

## ğŸ”’ Security Notes

- Keep `.env` file out of version control (already in .gitignore)
- Use environment variables for all secrets
- Configure CORS_ORIGIN appropriately
- Validate and sanitize all user input
- Use HTTPS in production

## ğŸ“¦ Adding Dependencies

```bash
yarn workspace @monorepo/server add <package-name>
# or from server directory:
yarn add <package-name>
```

Add as dev dependency:
```bash
yarn workspace @monorepo/server add -D <package-name>
```

## ğŸš¢ Deployment

1. Build the project:
```bash
yarn build
```

2. Set environment variables on the server:
```bash
export DATABASE_URL=postgresql://...
export PORT=5000
export NODE_ENV=production
```

3. Run the server:
```bash
yarn start
```

Or use a process manager like PM2:
```bash
pm2 start dist/index.js --name "api-server"
```

## ğŸ“š Resources

- [Express.js Guide](https://expressjs.com/en/starter/basic-routing.html)
- [Prisma ORM](https://www.prisma.io/docs/)
- [PostgreSQL](https://www.postgresql.org/docs/)
- [TypeScript](https://www.typescriptlang.org/docs/)
